# 📖 lookFlv 用户手册

## 目录

- [概述](#概述)
- [界面介绍](#界面介绍)
- [功能详解](#功能详解)
- [高级特性](#高级特性)
- [配置说明](#配置说明)
- [常见问题](#常见问题)

## 📋 概述

lookFlv是一个专业的FLV（Flash Video）文件分析工具，提供完整的FLV文件解析、播放、分析和调试功能。支持图形界面和命令行两种操作模式，适合视频开发者、流媒体工程师和音视频爱好者使用。

### 主要功能

- **完整FLV播放** - 基于moviepy的高质量视频播放
- **深度文件分析** - FLV结构解析、元数据提取、时间轴分析
- **可视化工具** - GOP结构图、时间轴图表、十六进制查看器
- **实时监控** - 流数据监控、比特率分析、错误检测
- **插件扩展** - 支持AVS3、VVC等新格式解析
- **多模式操作** - GUI图形界面和CLI命令行双模式

## 🖥️ 界面介绍

### 主窗口布局

```
┌─────────────────────────────────────────────────────┐
│ 菜单栏: 文件 编辑 查看 工具 帮助                        │
├─────────────────────────────────────────────────────┤
│ 工具栏: [打开] [播放] [暂停] [停止] [设置]              │
├──────────────┬──────────────────────────────────────┤
│              │ 标签页区域:                           │
│   文件列表   │ ┌─ 视频预览 ─ 时间轴 ─ 十六进制 ─┐     │
│              │ │                               │     │
│   (左侧)     │ │        主要内容区域            │     │
│              │ │                               │     │
│              │ └───────────────────────────────┘     │
├──────────────┼──────────────────────────────────────┤
│              │ 属性面板:                             │
│              │ • 文件属性                           │
│              │ • 视频信息                           │
│              │ • 音频信息                           │
├──────────────┴──────────────────────────────────────┤
│ 状态栏: 文件状态 | 播放进度 | 系统信息                 │
└─────────────────────────────────────────────────────┘
```

### 菜单栏功能

**文件菜单**
- `打开文件 (Ctrl+O)` - 选择并打开FLV文件
- `最近文件` - 快速访问最近打开的文件
- `导出报告` - 导出分析报告到文件
- `退出 (Ctrl+Q)` - 关闭程序

**编辑菜单**
- `复制信息 (Ctrl+C)` - 复制当前选中的文件信息
- `清空历史` - 清空最近文件列表
- `首选项` - 打开设置对话框

**查看菜单**
- `全屏播放 (F11)` - 全屏播放视频
- `显示/隐藏面板` - 控制界面各面板显示
- `刷新 (F5)` - 刷新当前分析

**工具菜单**
- `格式转换` - 转换视频格式
- `批量分析` - 批量处理多个文件
- `插件管理` - 管理扩展插件

### 工具栏功能

| 图标 | 功能 | 快捷键 | 说明 |
|------|------|--------|------|
| 📁 | 打开文件 | Ctrl+O | 浏览并选择FLV文件 |
| ▶️ | 播放 | 空格 | 开始播放视频 |
| ⏸️ | 暂停 | 空格 | 暂停视频播放 |
| ⏹️ | 停止 | Esc | 停止播放并重置 |
| 🔊 | 音量 | - | 调节播放音量 |
| ⚙️ | 设置 | - | 打开程序设置 |

## 🎯 功能详解

### 1. 视频播放功能

#### 基本播放控制

**打开文件**
- 支持格式：.flv文件
- 方式1：菜单 → 文件 → 打开文件
- 方式2：工具栏打开按钮
- 方式3：拖拽文件到窗口
- 方式4：双击文件列表中的文件

**播放控制**
```
播放/暂停: 空格键或播放按钮
停止: Esc键或停止按钮  
全屏: F11键
音量: 鼠标滚轮或音量滑块
进度: 拖拽进度条或点击进度条
```

**播放信息显示**
- 当前时间/总时长
- 播放状态指示
- 缓冲进度
- 播放速度

#### 高级播放选项

**播放设置**
- 播放速度调节（0.25x - 4.0x）
- 音频通道选择
- 视频质量选择
- 循环播放模式

**快捷键列表**
```
空格      播放/暂停
Esc       停止播放
F11       全屏/窗口切换
→         快进5秒
←         后退5秒
↑         音量增加
↓         音量减少
M         静音切换
Ctrl+O    打开文件
Ctrl+Q    退出程序
```

### 2. 文件分析功能

#### FLV结构分析

**FLV头部信息**
- 文件签名验证
- 版本信息
- 音频/视频标志位
- 头部长度

**标签解析**
- 音频标签统计
- 视频标签统计
- 脚本数据标签
- 时间戳信息

**元数据提取**
```
基本信息:
- 文件大小、时长
- 创建时间、修改时间
- 编码器信息

视频信息:
- 分辨率 (宽×高)
- 帧率 (fps)
- 编码格式 (H.264/H.265等)
- 比特率

音频信息:
- 采样率 (Hz)
- 声道数 (单声道/立体声)
- 编码格式 (AAC/MP3等)
- 比特率
```

#### 时间轴分析

**数据流可视化**
- 音频数据流时序图
- 视频数据流时序图
- 混合数据流图表
- 比特率变化曲线

**同步分析**
- 音画同步检测
- 时间戳偏移分析
- 帧丢失检测
- 延迟测量

### 3. 可视化工具

#### 时间轴图表

**图表类型**
- 线性时间轴：显示数据包时序
- 柱状图：显示数据包大小分布
- 散点图：显示时间戳分布
- 热力图：显示数据密度

**交互功能**
- 缩放：鼠标滚轮或缩放工具
- 平移：拖拽图表
- 选择：框选区域查看详情
- 标记：添加时间点标记

#### GOP结构图

**帧类型可视化**
- I帧（关键帧）：红色标记
- P帧（预测帧）：绿色标记  
- B帧（双向帧）：蓝色标记

**结构分析**
- GOP长度统计
- 关键帧间隔
- 帧类型分布
- 压缩效率分析

#### 十六进制查看器

**显示功能**
- 十六进制数据显示
- ASCII字符对照
- 地址偏移显示
- 数据搜索功能

**标签定位**
- FLV标签高亮显示
- 标签类型颜色编码
- 快速跳转到指定标签
- 标签边界标记

### 4. 实时监控

#### 流数据监控

**监控面板**
- 实时比特率图表
- 数据包计数器
- 错误统计
- 网络延迟（如适用）

**警报系统**
- 比特率异常警报
- 帧丢失警报
- 音画不同步警报
- 文件损坏警报

## 🔧 高级特性

### 1. 插件系统

#### 内置插件

**AVS3解析插件**
- 支持AVS3视频编码标准
- AVS3头部信息解析
- AVS3特有参数显示

**VVC解析插件**
- 支持VVC(H.266)视频编码
- VVC语法元素解析
- 新一代编码特性分析

#### 插件管理

**安装插件**
```bash
# 方法1：通过插件管理器
工具 → 插件管理 → 安装插件

# 方法2：手动安装
将插件文件放入 plugins/ 目录
重启程序自动加载
```

**插件开发**
- 提供插件API接口
- 支持自定义解析器
- 事件钩子系统
- 详见 `docs/developer_guide.md`

### 2. 批量处理

#### 批量分析

**GUI模式**
1. 工具 → 批量分析
2. 选择多个FLV文件
3. 选择分析选项
4. 开始批量处理
5. 查看汇总报告

**CLI模式**
```bash
# 批量分析当前目录所有FLV文件
python main.py --cli batch *.flv --output report.html

# 指定分析选项
python main.py --cli batch *.flv --detailed --format json
```

#### 报告生成

**报告格式**
- HTML报告：网页格式，包含图表
- JSON报告：结构化数据，便于程序处理
- CSV报告：表格格式，便于Excel处理
- PDF报告：便于打印和分享

**报告内容**
- 文件基本信息汇总
- 质量评估结果
- 问题检测结果
- 对比分析图表

### 3. 格式转换

#### 支持的转换格式

**输出格式**
- MP4：通用格式，兼容性好
- AVI：经典格式，支持多种编码
- MOV：Apple格式，质量优秀
- MKV：开源格式，功能强大

**转换选项**
- 视频编码：H.264, H.265, VP9等
- 音频编码：AAC, MP3, OGG等
- 分辨率调整
- 比特率控制
- 质量预设

#### 转换操作

**GUI转换**
1. 打开FLV文件
2. 工具 → 格式转换
3. 选择输出格式和参数
4. 点击开始转换
5. 等待转换完成

**CLI转换**
```bash
# 基本转换
python main.py --cli convert input.flv output.mp4

# 高级选项
python main.py --cli convert input.flv output.mp4 \
  --video-codec h264 \
  --audio-codec aac \
  --bitrate 2000k \
  --resolution 1920x1080
```

## ⚙️ 配置说明

### 程序设置

#### 通用设置

**界面设置**
- 语言选择：中文/英文
- 主题选择：浅色/深色
- 字体大小调节
- 界面布局保存

**播放设置**
- 默认音量
- 自动播放选项
- 播放质量预设
- 硬件加速

#### 高级设置

**性能设置**
- 内存使用限制
- 缓存大小设置
- 多线程处理
- GPU加速选项

**分析设置**
- 分析精度级别
- 错误检测阈值
- 自动修复选项
- 插件启用状态

### 配置文件

#### 配置文件位置

```
Windows: %APPDATA%/lookFlv/config.json
Linux:   ~/.config/lookFlv/config.json
macOS:   ~/Library/Application Support/lookFlv/config.json
```

#### 配置文件格式

```json
{
  "general": {
    "language": "zh-CN",
    "theme": "light",
    "font_size": 12
  },
  "player": {
    "default_volume": 80,
    "auto_play": false,
    "hardware_acceleration": true
  },
  "analysis": {
    "precision_level": "high",
    "error_threshold": 0.1,
    "auto_repair": false
  },
  "plugins": {
    "avs3_parser": true,
    "vvc_parser": true
  }
}
```

## ❓ 常见问题

### 播放相关问题

**Q: 视频无法播放，显示"格式不支持"**
```
A: 检查以下几点：
1. 确认文件是有效的FLV格式
2. 检查moviepy库是否正确安装
3. 尝试使用其他FLV文件测试
4. 查看程序日志获取详细错误信息
```

**Q: 播放过程中出现卡顿**
```
A: 可能的解决方案：
1. 降低播放质量设置
2. 关闭其他占用资源的程序
3. 检查硬盘空间是否充足
4. 尝试启用硬件加速
```

**Q: 音频播放正常但视频黑屏**
```
A: 处理步骤：
1. 检查视频编码格式是否支持
2. 更新显卡驱动程序
3. 禁用硬件加速尝试软件解码
4. 检查文件是否损坏
```

### 分析相关问题

**Q: 分析功能报错或结果不准确**
```
A: 排查方法：
1. 确认FLV文件完整性
2. 检查construct库版本
3. 尝试不同的分析精度设置
4. 查看详细日志信息
```

**Q: 十六进制查看器显示异常**
```
A: 解决方案：
1. 检查文件读取权限
2. 确认文件大小不超过限制
3. 尝试重新打开文件
4. 检查内存使用情况
```

### 性能相关问题

**Q: 程序启动缓慢**
```
A: 优化建议：
1. 关闭不必要的插件
2. 清理程序缓存
3. 减少启动时自动加载的功能
4. 检查系统资源使用情况
```

**Q: 大文件处理慢**
```
A: 提升性能：
1. 增加内存缓存设置
2. 启用多线程处理
3. 使用SSD存储
4. 降低分析精度
```

### 界面相关问题

**Q: 字体显示异常或乱码**
```
A: 解决步骤：
1. 程序已自动适配中文字体
2. 确保系统安装有中文字体
3. 检查系统区域设置
4. 尝试手动设置字体
```

**Q: 界面布局混乱**
```
A: 恢复方法：
1. 编辑 → 首选项 → 重置界面布局
2. 删除配置文件重新启动
3. 检查屏幕分辨率设置
4. 尝试不同的主题
```

## 📞 技术支持

如果本手册未能解决您的问题，请通过以下方式获取帮助：

1. **查看日志文件** - `logs/lookflv_YYYYMMDD.log`
2. **运行诊断工具** - `python scripts/dependency_check.py`
3. **提交Issue** - https://github.com/username/lookFlv/issues
4. **邮件联系** - developer@example.com

提交问题时请包含以下信息：
- 操作系统版本
- Python版本
- 程序版本
- 错误日志
- 复现步骤

---

*本手册持续更新中，最新版本请查看项目仓库。*